/*!
 * TableExport.js v3.1.3 (http://www.clarketravis.com)
 * Copyright 2015 Travis Clarke
 * Licensed under the MIT license
 */
!function(t,n){function e(t){return String(t).replace(/[&<>'\/]/g,function(t){return s.fn.tableExport.entityMap[t]})}function a(t,n){n&&(t+=1462);var e=Date.parse(t);return(e-new Date(Date.UTC(1899,11,30)))/864e5}function o(t,n){for(var e={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=t.length;++r)for(var l=0;l!=t[r].length;++l){o.s.r>r&&(o.s.r=r),o.s.c>l&&(o.s.c=l),o.e.r<r&&(o.e.r=r),o.e.c<l&&(o.e.c=l);var f={v:t[r][l]};if(null!=f.v){var s=XLSX.utils.encode_cell({c:l,r:r});"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.t="n",f.z=XLSX.SSF._table[14],f.v=a(f.v)):f.t="s",e[s]=f}}return o.s.c<1e7&&(e["!ref"]=XLSX.utils.encode_range(o)),e}function r(){return this instanceof r?(this.SheetNames=[],void(this.Sheets={})):new r}function l(t){for(var n=new ArrayBuffer(t.length),e=new Uint8Array(n),a=0;a!=t.length;++a)e[a]=255&t.charCodeAt(a);return n}function f(t,n){var e=new r,a=o(t);e.SheetNames.push(n),e.Sheets[n]=a;var f={bookType:"xlsx",bookSST:!1,type:"binary"},s=XLSX.write(e,f);saveAs(new Blob([l(s)],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n+".xlsx")}var s=t.jQuery;s.fn.tableExport=function(t){var n,a,o,r=s.extend({},s.fn.tableExport.defaults,t),l=s.fn.tableExport.rowDel;return r.bootstrap?(n=s.fn.tableExport.bootstrap[0]+" ",a=s.fn.tableExport.bootstrap[1]+" ",o=s.fn.tableExport.bootstrap[2]+" "):(n=s.fn.tableExport.defaultButton+" ",a=o=""),this.each(function(){function t(t){var n=x.find("caption:not(.head)");n.length?n.append(t):x.prepend('<caption class="'+o+r.position+'">'+t+"</caption>")}function i(e,o,r,l){var f='<a href="'+e+'" download="'+o+'" role="button" class="'+n+a+l+'">'+r+"</a>";t(f)}function p(e,o,r,l){var f="<a href='#' data-obj='"+e+"' download='"+o+"' role='button' class='"+n+a+l+"'>"+r+"</a>";t(f),u(l)}function u(t){var n="."+t;return s(n).on("click",function(t){if(s(this).data("obj")){t.preventDefault();var n=s(this).data("obj"),e=n.data,a=n.name;f(e,a)}})}var x=s(this),c=r.headings?x.find("tr"):x.find("tr:has(td)"),b="id"===r.fileName?x.attr("id")?x.attr("id"):s.fn.tableExport.defaultFileName:r.fileName,d={xlsx:function(t,n){var a=c.map(function(t,n){var e=s(n).find("th, td");return[e.map(function(t,n){return s(n).text()}).get()]}).get(),o=e(JSON.stringify({data:a,name:n})),r=n+".xlsx",l=s.fn.tableExport.xlsx.buttonContent,f=s.fn.tableExport.xlsx.defaultClass;p(o,r,l,f)},xls:function(t,n){var e=s.fn.tableExport.xls.separator,a="data:application/vnd.ms-excel;charset=utf-8,"+encodeURIComponent(c.map(function(t,n){var a=s(n).find("th, td");return a.map(function(t,n){return s(n).text()}).get().join(e)}).get().join(t)),o=n+".xls",r=s.fn.tableExport.xls.buttonContent,l=s.fn.tableExport.xls.defaultClass;i(a,o,r,l)},csv:function(t,n){t='"'+t+'"';var e='"'+s.fn.tableExport.csv.separator+'"',a="data:text/csv;charset=utf-8,"+encodeURIComponent('"'+c.map(function(t,n){var a=s(n).find("th, td");return a.map(function(t,n){return s(n).text().replace(/"/g,'""')}).get().join(e)}).get().join(t)+'"'),o=n+".csv",r=s.fn.tableExport.csv.buttonContent,l=s.fn.tableExport.csv.defaultClass;i(a,o,r,l)},txt:function(t,n){var e=s.fn.tableExport.txt.separator,a="data:text/plain;charset=utf-8,"+encodeURIComponent(c.map(function(t,n){var a=s(n).find("th, td");return a.map(function(t,n){return s(n).text()}).get().join(e)}).get().join(t)),o=n+".txt",r=s.fn.tableExport.txt.buttonContent,l=s.fn.tableExport.txt.defaultClass;i(a,o,r,l)}};r.formats.forEach(function(t){d[t](l,b)})})},s.fn.tableExport.defaults={headings:!0,formats:["xls","csv","txt"],fileName:"id",bootstrap:!0,position:"bottom"},s.fn.tableExport.xlsx={defaultClass:"xlsx",buttonContent:"Export to xlsx"},s.fn.tableExport.xls={defaultClass:"xls",buttonContent:"Export to xls",separator:"	"},s.fn.tableExport.csv={defaultClass:"csv",buttonContent:"Export to csv",separator:","},s.fn.tableExport.txt={defaultClass:"txt",buttonContent:"Export to txt",separator:"  "},s.fn.tableExport.defaultFileName="myDownload",s.fn.tableExport.defaultButton="button-default",s.fn.tableExport.bootstrap=["btn","btn-default","btn-toolbar"],s.fn.tableExport.rowDel="\r\n",s.fn.tableExport.entityMap={"&":"&#38;","<":"&#60;",">":"&#62;","'":"&#39;","/":"&#47"}}(window);